<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1407px" preserveAspectRatio="none" style="width:966px;height:1407px;background:#FFFFFE;" version="1.1" viewBox="0 0 966 1407" width="966px" zoomAndPan="magnify"><defs><filter height="300%" id="fje6dszjd231r" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="Menlo" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="216" x="370.5" y="26.708">メッセージの受け取り変更</text><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="1179.75" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="34" y="131.25"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="77.4297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="276" y="629.375"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="522.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="276" y="779.0703"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="203.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="509" y="415.5781"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="312" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="509" y="918.7344"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="59.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="239.7813"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="59.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="444.7109"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="533.1094"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="576.2422"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="59.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="1013.9375"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="1102.3359"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="1187.6016"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="117.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="887" y="210.6484"/><rect fill="#FFFFFE" filter="url(#fje6dszjd231r)" height="120.4688" style="stroke: #000000; stroke-width: 2.0;" width="476" x="185" y="865.3359"/><rect fill="#FFFFFE" height="59.0703" style="stroke: none; stroke-width: 1.0;" width="476" x="185" y="926.7344"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="39" x2="39" y1="121.25" y2="1320"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="281" x2="281" y1="630.8906" y2="1320"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="514" x2="514" y1="121.25" y2="1320"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="759" x2="759" y1="121.25" y2="1320"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="892" x2="892" y1="121.25" y2="1320"/><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="117.9482">ユーザー</text><ellipse cx="39" cy="47.9531" fill="#FEFECE" filter="url(#fje6dszjd231r)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,55.9531 L39,82.9531 M26,63.9531 L52,63.9531 M39,82.9531 L26,97.9531 M39,82.9531 L52,97.9531 " fill="none" filter="url(#fje6dszjd231r)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="1331.9951">ユーザー</text><ellipse cx="39" cy="1345.2969" fill="#FEFECE" filter="url(#fje6dszjd231r)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,1353.2969 L39,1380.2969 M26,1361.2969 L52,1361.2969 M39,1380.2969 L26,1395.2969 M39,1380.2969 L52,1395.2969 " fill="none" filter="url(#fje6dszjd231r)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#99FF99" filter="url(#fje6dszjd231r)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="195" y="1319"/><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="202" y="1338.9951">メッセージ受け取り画面</text><rect fill="#FEFECE" filter="url(#fje6dszjd231r)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="270" x="377" y="69.6563"/><text fill="#000000" font-family="Menlo" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="464" y="89.6514">«Controller»</text><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="256" x="384" y="105.9482">MessageReceptionPermissionConfig</text><rect fill="#FEFECE" filter="url(#fje6dszjd231r)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="270" x="377" y="1319"/><text fill="#000000" font-family="Menlo" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="464" y="1338.9951">«Controller»</text><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="256" x="384" y="1355.292">MessageReceptionPermissionConfig</text><rect fill="#FEFECE" filter="url(#fje6dszjd231r)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="722" y="69.6563"/><text fill="#000000" font-family="Menlo" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="56" x="729" y="89.6514">«Model»</text><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="741" y="105.9482">User</text><rect fill="#FEFECE" filter="url(#fje6dszjd231r)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="722" y="1319"/><text fill="#000000" font-family="Menlo" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="56" x="729" y="1338.9951">«Model»</text><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="741" y="1355.292">User</text><rect fill="#FEFECE" filter="url(#fje6dszjd231r)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="110" x="835" y="69.6563"/><text fill="#000000" font-family="Menlo" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="842" y="89.6514">«Controller»</text><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="858" y="105.9482">Messages</text><rect fill="#FEFECE" filter="url(#fje6dszjd231r)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="110" x="835" y="1319"/><text fill="#000000" font-family="Menlo" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="842" y="1338.9951">«Controller»</text><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="858" y="1355.292">Messages</text><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="1179.75" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="34" y="131.25"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="77.4297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="276" y="629.375"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="522.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="276" y="779.0703"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="203.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="509" y="415.5781"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="312" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="509" y="918.7344"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="59.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="239.7813"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="59.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="444.7109"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="533.1094"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="576.2422"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="59.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="1013.9375"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="1102.3359"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="754" y="1187.6016"/><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="117.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="887" y="210.6484"/><rect fill="#EEEEEE" filter="url(#fje6dszjd231r)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="951" x="3" y="151.8164"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="954" y1="151.8164" y2="151.8164"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="954" y1="154.8164" y2="154.8164"/><rect fill="#EEEEEE" filter="url(#fje6dszjd231r)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="152" x="402.5" y="141.25"/><text fill="#000000" font-family="Menlo" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="130" x="408.5" y="157.3169">メッセージ画面を表示</text><polygon fill="#A80036" points="875,206.6484,885,210.6484,875,214.6484,879,210.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="881" y1="210.6484" y2="210.6484"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="51" y="190.4497">メッセージを開く</text><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="51" y="205.5825">:index()</text><polygon fill="#A80036" points="775,235.7813,765,239.7813,775,243.7813,771,239.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="769" x2="886" y1="239.7813" y2="239.7813"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="781" y="234.7153">ログイン状態か？</text><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="120" x="719" y="247.7813"/><polygon fill="#EEEEEE" points="719,247.7813,788,247.7813,788,254.7813,778,264.7813,719,264.7813,719,247.7813" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Menlo" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="732" y="261.8481">ref</text><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="725" y="280.8481">ログインチェック!</text><polygon fill="#A80036" points="875,295.0469,885,299.0469,875,303.0469,879,299.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="759" x2="881" y1="299.0469" y2="299.0469"/><polygon fill="#A80036" points="55,324.1797,45,328.1797,55,332.1797,51,328.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="49" x2="891" y1="328.1797" y2="328.1797"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="61" y="323.1138">メッセージ画面を表示</text><rect fill="#EEEEEE" filter="url(#fje6dszjd231r)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="951" x="3" y="356.7461"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="954" y1="356.7461" y2="356.7461"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="954" y1="359.7461" y2="359.7461"/><rect fill="#EEEEEE" filter="url(#fje6dszjd231r)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="230" x="363.5" y="346.1797"/><text fill="#000000" font-family="Menlo" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="369.5" y="362.2466">メッセージ受け取り設定画面を表示</text><polygon fill="#A80036" points="497,411.5781,507,415.5781,497,419.5781,501,415.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="503" y1="415.5781" y2="415.5781"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="51" y="395.3794">メッセージ受け取り設定を開く</text><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="51" y="410.5122">:show()</text><polygon fill="#A80036" points="742,440.7109,752,444.7109,742,448.7109,746,444.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="748" y1="444.7109" y2="444.7109"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="526" y="439.645">ログイン状態か？</text><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="120" x="719" y="452.7109"/><polygon fill="#EEEEEE" points="719,452.7109,788,452.7109,788,459.7109,778,469.7109,719,469.7109,719,452.7109" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Menlo" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="732" y="466.7778">ref</text><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="725" y="485.7778">ログインチェック!</text><polygon fill="#A80036" points="530,499.9766,520,503.9766,530,507.9766,526,503.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="524" x2="758" y1="503.9766" y2="503.9766"/><polygon fill="#A80036" points="742,529.1094,752,533.1094,742,537.1094,746,533.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="748" y1="533.1094" y2="533.1094"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="526" y="528.0435">current_userを取得</text><polygon fill="#A80036" points="530,543.1094,520,547.1094,530,551.1094,526,547.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="524" x2="758" y1="547.1094" y2="547.1094"/><polygon fill="#A80036" points="742,572.2422,752,576.2422,742,580.2422,746,576.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="748" y1="576.2422" y2="576.2422"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="526" y="571.1763">現在の受け取り設定を取得</text><polygon fill="#A80036" points="530,586.2422,520,590.2422,530,594.2422,526,590.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="524" x2="758" y1="590.2422" y2="590.2422"/><polygon fill="#A80036" points="378,615.375,368,619.375,378,623.375,374,619.375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="372" x2="513" y1="619.375" y2="619.375"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="384" y="614.3091">受け取り設定を渡す</text><rect fill="#99FF99" filter="url(#fje6dszjd231r)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="195" y="598.2422"/><text fill="#000000" font-family="Menlo" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="202" y="618.2373">メッセージ受け取り画面</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="286" x2="328" y1="664.6719" y2="664.6719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="328" x2="328" y1="664.6719" y2="677.6719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287" x2="328" y1="677.6719" y2="677.6719"/><polygon fill="#A80036" points="297,673.6719,287,677.6719,297,681.6719,293,677.6719" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="293" y="659.606">受け取りトグルの値を反映する</text><polygon fill="#A80036" points="55,702.8047,45,706.8047,55,710.8047,51,706.8047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="49" x2="280" y1="706.8047" y2="706.8047"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="61" y="701.7388">メッセージ受け取り設定画面を表示</text><rect fill="#EEEEEE" filter="url(#fje6dszjd231r)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="951" x="3" y="735.3711"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="954" y1="735.3711" y2="735.3711"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="954" y1="738.3711" y2="738.3711"/><rect fill="#EEEEEE" filter="url(#fje6dszjd231r)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="204" x="376.5" y="724.8047"/><text fill="#000000" font-family="Menlo" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="182" x="382.5" y="740.8716">メッセージ受け取り設定をする</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="274" x2="264" y1="779.0703" y2="775.0703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="274" x2="264" y1="779.0703" y2="783.0703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="275" y1="779.0703" y2="779.0703"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="51" y="774.0044">メッセージの受け取りトグルを押す</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="286" x2="328" y1="808.2031" y2="808.2031"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="328" x2="328" y1="808.2031" y2="821.2031"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287" x2="328" y1="821.2031" y2="821.2031"/><polygon fill="#A80036" points="297,817.2031,287,821.2031,297,825.2031,293,821.2031" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="293" y="803.1372">受け取りトグルの値を反転する</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="54" y1="850.3359" y2="846.3359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="54" y1="850.3359" y2="854.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="44" x2="275" y1="850.3359" y2="850.3359"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="61" y="845.27">受け取りトグルを反映する</text><path d="M185,865.3359 L254,865.3359 L254,872.3359 L244,882.3359 L185,882.3359 L185,865.3359 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="120.4688" style="stroke: #000000; stroke-width: 2.0;" width="476" x="185" y="865.3359"/><text fill="#000000" font-family="Menlo" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="200" y="878.4028">alt</text><text fill="#000000" font-family="Menlo" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="269" y="877.5464">[受け取りトグルがオン]</text><polygon fill="#A80036" points="497,914.7344,507,918.7344,497,922.7344,501,918.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="286" x2="503" y1="918.7344" y2="918.7344"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="293" y="898.5356">POST 受け取り:trueを送る</text><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="293" y="913.6685">:update()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="185" x2="661" y1="927.7344" y2="927.7344"/><text fill="#000000" font-family="Menlo" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="190" y="937.9448">[受け取りトグルがオフ]</text><polygon fill="#A80036" points="497,973.8047,507,977.8047,497,981.8047,501,977.8047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="286" x2="503" y1="977.8047" y2="977.8047"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="293" y="957.606">POST 受け取り:falseを送る</text><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="293" y="972.7388">:update()</text><polygon fill="#A80036" points="742,1009.9375,752,1013.9375,742,1017.9375,746,1013.9375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="748" y1="1013.9375" y2="1013.9375"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="526" y="1008.8716">ログイン状態か？</text><rect fill="#FFFFFF" filter="url(#fje6dszjd231r)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="120" x="719" y="1021.9375"/><polygon fill="#EEEEEE" points="719,1021.9375,788,1021.9375,788,1028.9375,778,1038.9375,719,1038.9375,719,1021.9375" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Menlo" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="732" y="1036.0044">ref</text><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="725" y="1055.0044">ログインチェック!</text><polygon fill="#A80036" points="530,1069.2031,520,1073.2031,530,1077.2031,526,1073.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="524" x2="758" y1="1073.2031" y2="1073.2031"/><polygon fill="#A80036" points="742,1098.3359,752,1102.3359,742,1106.3359,746,1102.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="748" y1="1102.3359" y2="1102.3359"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="526" y="1097.27">current_userを取得</text><polygon fill="#A80036" points="530,1112.3359,520,1116.3359,530,1120.3359,526,1116.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="524" x2="758" y1="1116.3359" y2="1116.3359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="561" y1="1145.4688" y2="1145.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="561" x2="561" y1="1145.4688" y2="1158.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="520" x2="561" y1="1158.4688" y2="1158.4688"/><polygon fill="#A80036" points="530,1154.4688,520,1158.4688,530,1162.4688,526,1158.4688" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="526" y="1140.4028">ストロングパラメータ</text><polygon fill="#A80036" points="742,1183.6016,752,1187.6016,742,1191.6016,746,1187.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="748" y1="1187.6016" y2="1187.6016"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="526" y="1182.5356">current_userを更新(パラメータ)</text><polygon fill="#A80036" points="530,1197.6016,520,1201.6016,530,1205.6016,526,1201.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="524" x2="758" y1="1201.6016" y2="1201.6016"/><polygon fill="#A80036" points="297,1226.7344,287,1230.7344,297,1234.7344,293,1230.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="291" x2="513" y1="1230.7344" y2="1230.7344"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="303" y="1225.6685">現在の受け取り設定を返す</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="286" x2="328" y1="1259.8672" y2="1259.8672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="328" x2="328" y1="1259.8672" y2="1272.8672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287" x2="328" y1="1272.8672" y2="1272.8672"/><polygon fill="#A80036" points="297,1268.8672,287,1272.8672,297,1276.8672,293,1272.8672" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="293" y="1254.8013">受け取りトグルの値に反映する</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="54" y1="1302" y2="1298"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="54" y1="1302" y2="1306"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="44" x2="280" y1="1302" y2="1302"/><text fill="#000000" font-family="Menlo" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="61" y="1296.9341">受け取りトグルを反映する</text><!--MD5=[5eaf0a1c2fc0b33e541845268e5ab40a]
@startuml
skinparam defaultFontName Menlo
skinparam backgroundColor #FFFFFE

title メッセージの受け取り変更

actor ユーザー as user
participant メッセージ受け取り画面 as messages_reception #99FF99
participant MessageReceptionPermissionConfig as MessageReceptionPermissionConfig <<Controller>>
participant User as User <<Model>>
participant Messages as Messages <<Controller>>

== メッセージ画面を表示 ==
activate user
user -> Messages: メッセージを開く\n:index()
activate Messages

Messages -> User: ログイン状態か？
activate User
ref over User: ログインチェック!
User - -> Messages
deactivate User

Messages - -> user: メッセージ画面を表示
deactivate Messages

== メッセージ受け取り設定画面を表示 ==
user -> MessageReceptionPermissionConfig: メッセージ受け取り設定を開く\n:show()
activate MessageReceptionPermissionConfig

MessageReceptionPermissionConfig -> User: ログイン状態か？
activate User
ref over User: ログインチェック!
User - -> MessageReceptionPermissionConfig
deactivate User

MessageReceptionPermissionConfig -> User: current_userを取得
activate User
User - -> MessageReceptionPermissionConfig
deactivate User

MessageReceptionPermissionConfig -> User: 現在の受け取り設定を取得
activate User
User - -> MessageReceptionPermissionConfig
deactivate User

create messages_reception
MessageReceptionPermissionConfig - -> messages_reception: 受け取り設定を渡す
activate messages_reception
deactivate MessageReceptionPermissionConfig

messages_reception -> messages_reception: 受け取りトグルの値を反映する

messages_reception - -> user: メッセージ受け取り設定画面を表示
deactivate messages_reception

== メッセージ受け取り設定をする ==

user ->> messages_reception: メッセージの受け取りトグルを押す
activate messages_reception
messages_reception -> messages_reception: 受け取りトグルの値を反転する
messages_reception - ->> user: 受け取りトグルを反映する

alt 受け取りトグルがオン
  messages_reception -> MessageReceptionPermissionConfig: POST 受け取り:trueを送る\n:update()
  activate MessageReceptionPermissionConfig
else 受け取りトグルがオフ
  messages_reception -> MessageReceptionPermissionConfig: POST 受け取り:falseを送る\n:update()
end

MessageReceptionPermissionConfig -> User: ログイン状態か？
activate User
ref over User: ログインチェック!
User - -> MessageReceptionPermissionConfig
deactivate User

MessageReceptionPermissionConfig -> User: current_userを取得
activate User
User - -> MessageReceptionPermissionConfig
deactivate User

MessageReceptionPermissionConfig -> MessageReceptionPermissionConfig: ストロングパラメータ

MessageReceptionPermissionConfig -> User: current_userを更新(パラメータ)
activate User
User - -> MessageReceptionPermissionConfig
deactivate User

MessageReceptionPermissionConfig - -> messages_reception: 現在の受け取り設定を返す
deactivate MessageReceptionPermissionConfig

messages_reception -> messages_reception: 受け取りトグルの値に反映する

messages_reception - ->> user: 受け取りトグルを反映する
deactivate messages_reception
@enduml

PlantUML version 1.2020.12(Sat Jun 06 19:54:15 JST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>